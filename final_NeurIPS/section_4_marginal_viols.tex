%!TEX root = main.tex

\section{Theoretical analysis and guarantees} % (fold)
\label{sec:analysis_of_marginal_violations}

% We derive in this section 
This section is devoted to establishing theoretical guarantees for \textsc{Screenkhorn} algorithm. %the marginal violations of
We first define the screened marginals $\mu^{\text{sc}} = B(u^{\text{sc}}, v^{\text{sc}}) \mathbf 1_m$ and $\nu^{\text{sc}} = B(u^{\text{sc}}, v^{\text{sc}})^\top \mathbf 1_n.$ 
Our first theoretical result, Proposition~\ref{proposition_error_in_marginals}, gives an upper bound of the screened marginal violations with respect to $\ell_1$-norm.

\begin{proposition}
\label{proposition_error_in_marginals}
Let $(u^{\text{sc}}, v^{\text{sc}})$ be an optimal pair solution of problem~\eqref{screen-sinkhorn_second_def}.
Then one has 
\begin{align}
\label{marginal-error-mu}
{\norm{{\mu} -{\mu}^{\text{sc}}}^2_1} = \bigO\Big(n_bc_\kappa + (n- n_b) \Big(\frac{\norm{C}_\infty}{\eta} + \frac{m_b}{\sqrt{nmc_{\mu\nu}}K_{\min}^{3/2}} &+ \frac{m-m_b}{\sqrt{nm}K_{\min}}
 + \log\Big(\frac{\sqrt{nm}}{m_bc_{\mu\nu}^{5/2}} 
\Big)\Big)\Big)
\end{align}
and 
\begin{align}
\label{marginal-error-nu}
{\norm{{\nu} -{\nu}^{\text{sc}}}^2_1} = \bigO\Big(m_bc_{\frac1\kappa} + (m- m_b) \Big(\frac{\norm{C}_\infty}{\eta} + \frac{n_b}{\sqrt{nmc_{\mu\nu}}K_{\min}^{3/2}} &+ \frac{n-n_b}{\sqrt{nm}K_{\min}}
 + \log\Big(\frac{\sqrt{nm}}{n_b c_{\mu\nu}^{5/2}}
\Big)\Big)\Big),
\end{align}
where $c_z = z - \log z - 1$ for $z>0$ and $c_{\mu\nu} = \underline{\mu}\wedge \underline{\nu}$ with $\underline{\mu} = \min_{i\in I_{\varepsilon,\kappa}}\mu_i$ and $\underline{\nu} = \min_{j\in J_{\varepsilon,\kappa}}\nu_j$.

\end{proposition}
Proof of Proposition~\ref{proposition_error_in_marginals} is presented in supplementary material and it is based on first order optimality conditions for problem~\eqref{screen-sinkhorn_second_def} and on a generalization of Pinsker inequality (see Lemma~\ref{lem:pinsker} in supplementary).
Note that $c_\kappa$ and $c_{\frac 1\kappa}$ tend to zeros as $\kappa$ goes to one, which is the case when the number budget of points $(n_b,m_b)$ tends to the full one $(n,m)$.

Our second theoretical result, Proposition~\ref{prop:objective-error}, is an upper bound of the difference between objective values of \textsc{Screenkhorn} and dual of Sinkhorn divergence~\eqref{sinkhorn-dual}. 
\begin{proposition}
\label{prop:objective-error}
Let $(u^{\text{sc}}, v^{\text{sc}})$ be an optimal pair solution of problem~\eqref{screen-sinkhorn_second_def} and $(u^\star, v^\star)$ is the pair solution of dual of Sinkhorn divergence~\eqref{sinkhorn-dual}. Then we have 
\begin{align*}
\Psi_{\varepsilon, \kappa}(u^{\text{sc}} ,v^{\text{sc}}) -\Psi(u^\star, v^\star)
= \bigO\Big(\Big(\frac{\norm{C}_\infty}{\eta} + \log\Big(\frac{(n\vee m)^2}{nmc_{\mu\nu}^{7/2}}\Big)\Big)(\norm{\mu - \mu^{\text{sc}}}_1 + \norm{\nu - \nu^{\text{sc}}}_1 + \omega_{\kappa}\Big).
\end{align*}
where $\omega_{\kappa} = (1- \kappa)\norm{\mu^{\text{sc}}}_1 + (\kappa^{-1} - 1)\norm{\nu^{\text{sc}}}_1 + \kappa^{-1} - \kappa$.
\end{proposition}
Proof of Proposition~\ref{prop:objective-error} is exposed in the supplementary material.
Comparing to some other analysis results of this quantity, see for instance Lemma 2 in~\cite{dvurechensky18aICML} and Lemma 3.1 in~\cite{lin2019}, our bound involves an additional term $\omega_{\kappa}$ (with $\omega_1 =0)$, that tends to zero as the pair budget $(n_b,m_b)$ goes to the full number budget of points $(n,m)$ (i.e., $\kappa$ goes to $1).$ 
\ar{To more characterize $\omega_\kappa$, a control of the $\ell_1$-norms of the screened marginals $\mu^{\text{sc}}$ and $\nu^{\text{sc}}$ are given in Lemma~\ref{lemma_bounds_on_marginals} in the supplementary material.}
% Equations~\eqref{l1-norm-mu-sc} and~\eqref{l1-norm-nu-sc} in

% section analysis_of_marginal_violations (end)

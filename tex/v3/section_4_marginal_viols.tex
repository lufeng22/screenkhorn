%!TEX root = main.tex

\section{Analysis of marginal violations} % (fold)
\label{sec:analysis_of_marginal_violations}

% We derive in this section 
This section is devoted to establishing theoretical guarantees for the marginal violations of Screenkhorn. 
We first define the screened marginals $\mu^{\text{sc}} = B(u^{\text{sc}}, v^{\text{sc}}) \mathbf 1_m$ and $\nu^{\text{sc}} = B(u^{\text{sc}}, v^{\text{sc}})^\top \mathbf 1_n.$ 
Lemma~\ref{lemma_bounds_on_marginals} expresses a lower and upper bounds with respect to $\ell_1$-norm of $\mu^{\text{sc}}$and $\nu^{\text{sc}}$, while Proposition~\ref{proposition_error_in_marginals} gives an upper bound of marginal errors.

\begin{lemma}
\label{lemma_bounds_on_marginals}
Let $(u^{\text{sc}}, v^{\text{sc}})$ be an optimal solution of problem~\eqref{screen-sinkhorn_second_def}.
Then one has 
\begin{align*}
 \kappa \norm{\mu_{I_{\varepsilon,\kappa}}^{\text{}}}_1 & + (n -n_b) \Big(\frac{mm_b\varepsilon^2 K_{\min}^2 \min_{j\in J_{\varepsilon, \kappa}} \nu_j}{ (n-n_b)m\kappa \varepsilon^2 K_{\min} + n_b\kappa^2 \max_{i\in I_{\varepsilon,\kappa}}\mu_i } + (m-m_b)\varepsilon^2K_{\min}\Big)\\
 & \leq \norm{\mu^{\text{sc}}}_1  \leq \kappa \norm{\mu_{I_{\varepsilon,\kappa}}^{\text{}}}_1 + (n-n_b) \Big(\frac{m_b\max_{j \in J_{\varepsilon,\kappa}} \nu_j}{n\kappa K_{\min}} + (m-m_b)\varepsilon^2 \Big)
\end{align*}
and 
\begin{align*}
\kappa^{-1} \norm{\nu_{J_{\varepsilon,\kappa}}^{\text{}}}_1 & + (m -m_b) \Big(\frac{nn_b\varepsilon^2\kappa^2K_{\min}^2 \min_{i\in I_{\varepsilon, \kappa}} \mu_j}{ n(m-m_b)\varepsilon^2 \kappa K_{\min} + m_b\kappa \max_{j\in J_{\varepsilon,\kappa}}\nu_j } + (n-n_b)\varepsilon^2K_{\min}\Big)\\
&\norm{\nu^{\text{sc}}}_1 \leq \kappa^{-1} \norm{\nu_{J_{\varepsilon,\kappa}}}_1 + (m-m_b)\Big(\frac{n_b\kappa \max_{i\in I_{\varepsilon,\kappa}}\mu_i}{m K_{\min}} + (n-n_b)\varepsilon^2\Big).
\end{align*}
\end{lemma}
\begin{proposition}
\label{proposition_error_in_marginals}
One has %\norm{\mu^{\text{sc}}}_1
\begin{align*}
{\norm{{\mu} -{\mu}^{\text{sc}}}^2_1}&\leq 7 n_b(\kappa-\log(\kappa)-1)\max_{i} \mu_i + 7 (n-n_b)\bigg(\frac{m_b\max_{j}\nu_j}{n\kappa K_{\min}} + (m- m_b) \varepsilon^2 - \min_{i}\\
&\qquad \mu_i + \max_{i} \mu_i\log\Big(\frac{\kappa(n-n_b+ 1)\max_{i} \mu_i}{m_b K_{\min}\min_{j \in J_{\varepsilon,\kappa}}\nu_j} + \frac{\kappa^2\max_{i} \mu_i}{mm_b\varepsilon^2K_{\min}^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}\Big)\bigg)
\end{align*}
and 
\begin{align*}
{\norm{{\nu} -{\nu}^{\text{sc}}}^2_1} &\leq 7 m_b(\kappa-\log(\kappa)-1)\max_{j} \nu_j + 7(m-m_b)\bigg(\frac{n_b\kappa\max_{i}\mu_i}{n K_{\min}} + (n- n_b) \varepsilon^2 - \min_{j}\nu_j\\ 
&\qquad + \max_{j} \nu_j\log\Big(\frac{\kappa(m-m_b+ 1)\max_{j} \nu_j}{n_b K_{\min}\min_{i \in I_{\varepsilon,\kappa}}\mu_i} + \frac{\kappa^2\max_{j} \nu_j}{nn_b\varepsilon^2K_{\min}^2\min_{i \in I_{\varepsilon,\kappa}}\mu_i}\Big)\bigg).
\end{align*}
\end{proposition}
Proofs of Lemma~\ref{lemma_bounds_on_marginals} and Proposition~\ref{proposition_error_in_marginals} are presented in supplementary material. 
Proof of Proposition~\ref{proposition_error_in_marginals} is based on a generalization of the Pinsker inequality~\cite{altschulernips17,khalilabid2018}.

% section analysis_of_marginal_violations (end)

\documentclass{article}

% if you need to pass options to natbib, use, e.g.:
% \PassOptionsToPackage{numbers, compress}{natbib}
% before loading neurips_2019

% ready for submission
% \usepackage{neurips_2019}

% to compile a preprint version, e.g., for submission to arXiv, add add the
% [preprint] option:
%\usepackage[preprint]{neurips_2019}

% to compile a camera-ready version, add the [final] option, e.g.:
% \usepackage[preprint]{neurips_2019}
\usepackage[]{neurips_2019}
% to avoid loading the natbib package, add option nonatbib:
% \usepackage[nonatbib]{neurips_2019}

\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography

%--------------------------------------------------------------------------------------------------------------------------------% 

\usepackage{xr}
\externaldocument{screenkhorn}

\RequirePackage{mathrsfs, amsthm, amsmath, amsfonts, amssymb, mathtools}%
\usepackage[titletoc,title]{appendix}%
\usepackage{dsfont}%
\usepackage{caption} % 
\usepackage{subcaption}
\usepackage{float}%
\usepackage{graphicx, color}% 
\usepackage{bm}%bold equations

%% FORMATTING APPNENDICES
\usepackage{etoolbox}
\patchcmd{\appendices}{\quad}{. }{}{}

%% TABLE
\usepackage{pgfplots}%
\usepackage{booktabs,multirow,array,multicol}
\newcommand{\otoprule}{\midrule[\heavyrulewidth]}

%% ALGORITHM
\usepackage[linesnumbered,ruled,vlined]{algorithm2e}

%% SECTIONS
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem{fact}{Fact}
\newtheorem{proposition}{Proposition}
\newtheorem{definition}{Definition}%[section]
\newtheorem*{notation}{Notation}%[section]
\newtheorem{discus}{Discussion}%[section]
\newtheorem{remark}{Remark}%[section]
\newtheorem{example}{Example}%[section]
\newtheorem{exs}{Examples}%[section]
\newtheorem{ca}{Cas}
\newtheorem{remarks}{Remarks}%[section]
\newtheorem{assumption}{Assumption}{\bf}{\rm}%

% MATH MACROS 

\usepackage{relsize}
\newcommand*{\defeq}{\stackrel{\mathsmaller{\mathsf{def.}}}{=}}

\newcommand{\ba}{\mathbf{a}}%
\newcommand{\bb}{\mathbf{b}}%

\newcommand{\bC}{{\mathbf C}}%
\newcommand{\bP}{{\mathbf P}}%
\newcommand{\bU}{{\mathbf U}}%

\newcommand{\cX}{\mathcal X}%
\newcommand{\cY}{\mathcal Y}%
\newcommand{\cM}{\mathcal M}%
\newcommand{\cC}{\mathcal C}%

\newcommand{\td}{\text d}%
\newcommand*{\argminl}{\argmin\limits}%
\newcommand{\bigO}{\mathcal{O}}
\newcommand{\bs}{\boldsymbol}
\newcommand{\sumin}{\sum_{i=1}^n}
\newcommand{\sumip}{\sum_{j=1}^m}
\newcommand{\intt}{\int_{0}^{t}}
\newcommand{\inttau}{\int_{0}^{\gamma}}
\newcommand{\I}{1\!\mbox{I}}
\newcommand{\e}{{\mathrm e}}
\newcommand{\diff}{\mathrm d}
\newcommand{\noi}{\noindent}
\newcommand{\eps}{\varepsilon}
\usepackage{datenumber}
\newcommand{\sptr}[2]{\langle #1 | #2 \rangle}
\newcommand{\inr}[1]{\langle #1 \rangle}
\newcommand{\inrbig}[1]{\bigg\langle #1 \bigg\rangle}
\newcommand{\ind}[1]{{\mathds{1}}_{{#1}}}%
\newcommand{\norm}[1]{\|#1\|}
\newcommand{\R}{{\mathbb{R}}}
\newcommand{\E}{\mathds{E}}
\newcommand{\V}{\mathds{V}}
\newcommand{\Lim}{\displaystyle \lim\limits}
\newcommand{\overbar}[1]{\mkern 1.5mu\overline{\mkern-1.5mu#1\mkern-1.5mu}\mkern 1.5mu}
\newcommand{\cD}{\mathcal D}
\newcommand{\cE}{\mathcal E}
\newcommand{\cT}{\mathcal T}
\newcommand{\bA}{{\boldsymbol A}}%
\newcommand{\bcA}{\boldsymbol{\mathcal{C}}}%
\newcommand{\bB}{{\boldsymbol B}}%
\newcommand{\bcB}{\boldsymbol{\mathcal{B}}}%
\newcommand{\bD}{{\boldsymbol D}}%
\newcommand{\bE}{{\boldsymbol E}}%
\newcommand{\bF}{{\boldsymbol F}}%
\newcommand{\bG}{{\boldsymbol G}}%
\newcommand{\bH}{{\boldsymbol H}}%
\newcommand{\bI}{{\boldsymbol I}}%
\newcommand{\bJ}{{\boldsymbol J}}%
\newcommand{\bK}{{\boldsymbol K}}%
\newcommand{\bL}{{\boldsymbol L}}%
\newcommand{\bM}{{\boldsymbol M}}%
\newcommand{\bN}{{\boldsymbol N}}%
\newcommand{\bO}{\boldsymbol 0}%
\newcommand{\bQ}{\boldsymbol Q}%
\newcommand{\bR}{\boldsymbol R}%
\newcommand{\cS}{{\mathcal{S}}}%
\newcommand{\bcQ}{\boldsymbol{\mathcal{Q}}}%
\newcommand{\bV}{\boldsymbol V}%
\newcommand{\bW}{\boldsymbol W}%
\newcommand{\bX}{\boldsymbol  X}%
\newcommand{\bT}{\boldsymbol  T}%
\newcommand{\bcE}{\boldsymbol{\mathcal{E}}}%
\newcommand{\bcH}{\boldsymbol{\mathcal{H}}}%
\newcommand{\bcX}{\boldsymbol{\mathcal{X}}}%
\newcommand{\bcJ}{\boldsymbol{\mathcal{J}}}%
\newcommand{\bcY}{\boldsymbol{\mathcal{Y}}}%
\newcommand{\bcW}{\boldsymbol{\mathcal{W}}}%
\newcommand{\bcT}{\boldsymbol{\mathcal{T}}}%
\newcommand{\bcM}{\boldsymbol{\mathcal{M}}}%
\newcommand{\bcZ}{\boldsymbol{\mathcal{Z}}}%
\newcommand{\bcO}{\boldsymbol{\mathcal{O}}}%
\newcommand{\bcG}{\boldsymbol{\mathcal{G}}}%
\newcommand{\bcU}{\boldsymbol{\mathcal{U}}}%
\newcommand{\bcV}{\boldsymbol{\mathcal{V}}}%
\newcommand{\bcR}{\boldsymbol{\mathcal{R}}}%
\newcommand{\bcI}{\boldsymbol{\mathcal{I}}}%
\newcommand{\by}{\boldsymbol y}%
\newcommand{\bu}{\boldsymbol u}%
\newcommand{\bv}{\boldsymbol  v}%
\newcommand{\bz}{\boldsymbol z}%
\newcommand{\bY}{\boldsymbol{Y}}%
\newcommand{\bZ}{\boldsymbol Z}
\newcommand{\bg}{\boldsymbol g}%
\newcommand{\beps}{\boldsymbol \varepsilon}%
\newcommand{\bSigma}{\boldsymbol \Sigma}%
\newcommand{\blambda}{\boldsymbol  \lambda}
\newcommand{\bbeta}{\boldsymbol  \beta}%
\newcommand{\bLambda}{\boldsymbol  \Lambda}%
\newcommand{\bTheta}{\boldsymbol  \Theta}
\newcommand{\bDelta}{\boldsymbol{\Delta}}%
\newcommand{\bXi}{\boldsymbol{\Xi}}%
\newcommand{\ov}{\overrightarrow}%
\newcommand{\cP}{\mathcal P}%
\newcommand{\cQ}{\mathcal Q}%
\renewcommand{\P}{\mathds{P}}
\newcommand{\bctheta}{\boldsymbol{\mathcal{\Theta}}}%
\newcommand{\btheta}{\boldsymbol  \Theta}%
\newcommand{\bcdot}{\raisebox{-0.80ex}{\scalebox{1.8}{$\cdot$}}}
\newcommand{\cst}{\raisebox{-0.15ex}{\scalebox{1.30}{$c$}}}
\newcommand{\Cst}{\raisebox{-0.15ex}{\scalebox{1.10}{$C$}}}
\newcommand{\varsig}{\raisebox{-0.15ex}{\scalebox{1.30}{$\varsigma$}}}
\usepackage{accents}
\newcommand*{\dt}[1]{\accentset{\mbox{\large\bfseries .}}{#1}}
%{\accentset{\raisebox{0ex}{$.$}}{#1}}
\newcommand*{\ddt}[1]{\accentset{\raisebox{0ex}{$\,\,\star$}}{#1}}

\newcommand*{\fstderiv}[1]{\accentset{\mbox{\Large\bfseries .}}{#1}}
\newcommand*{\scdderiv}[1]{\accentset{\mbox{\Large\bfseries .\hspace{-0.25ex}.}}{#1}}

%% MATH OPERATORS
\DeclareMathOperator*{\argmin}{\arg\!\min}
\DeclareMathOperator*{\argmax}{\arg\!\max}

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}



\usepackage[colorinlistoftodos,prependcaption,textsize=tiny]{todonotes}
%--------------------------------------------------------------------------------------------------------------------------------%

\title{Supplement to ``Screening Sinkhorn Algorithm via Dual Projections''}

\begin{document}

\maketitle

\section{Proof of Lemma~\ref{lemma_actives_sets}}

Introducing two dual variables $\lambda \in \R^n_{+}$ and $\beta \in \R^m_{+}$ for each constraint, the Lagrangian of problem~\eqref{screen-sinkhorn} reads as 
\begin{equation*}
  \mathscr{L}(u,v, \lambda, \beta) = \frac \varepsilon\kappa\inr{\lambda, \mathbf{1}_n} + \varepsilon\kappa\inr{\beta, \mathbf{1}_m} + \mathbf{1}_n^\top B(u,v) \mathbf{1}_m - \inr{\kappa u, \mu} - \inr{\frac v\kappa, \nu} -\inr{\lambda,e^{u}} - \inr{\beta,e^{v}}
\end{equation*}
First order conditions then yield that the Lagrangian multiplicators solutions $\lambda^{*}$ and $\beta^{*}$ satisfy 
\begin{align*}
  &\nabla_u\mathscr{L}(u^{*},v^{*}, \lambda^{*}, \beta^{*})=  e^{u^{*}} \odot(Ke^{v^{*}} - \lambda^{*}) - \kappa\mu = \mathbf 0_n,\\
  & \text{ and } \nabla_v\mathscr{L}(u^{*},v^{*}, \lambda^{*}, \beta^{*})=  e^{v^{*}} \odot(K^\top e^{u^{*}} - \beta) - \frac \nu\kappa = \mathbf 0_m
\end{align*}
which leads to 
\begin{align*}
  &\lambda^{*} = K e^{v^{*}} - \kappa\mu \oslash e^{u^{*}} \text{ and }
  \beta^{*} = K^\top e^{u^{*}} - \nu \oslash \kappa e^{v^{*}}
\end{align*}

For all $i=1, \ldots, n$ we have that $e^{u^{*}_i} \geq \varepsilon\kappa^{-1}$. Further, the condition on the dual variable $\lambda^{*}_i > 0$  ensures that $e^{u^{*}_i} = \varepsilon\kappa^{-1}$ and hence $i \in I^\complement_{\varepsilon,\kappa}$. We have that $\lambda^{*}_i > 0$ is equivalent to $e^{u^{*}_i}r_i(K) e^{v^{*}_j} >  \kappa{\mu_i}$ which  is satisfied when $\varepsilon^2r_i(K) >  \kappa{\mu_i}.$  
In a symmetric way we can prove the same statement for $e^{v^{*}_j}$.

$\hfill\square$


\section{Proof of Lemma~\ref{lemma_bounds_of_usc_and_vsc}}

We prove only the first statement~\eqref{bound_on_u} and similarly we can prove the second statement~\eqref{bound_on_v}.
For all $i\in I_{\varepsilon,\kappa}$, we have $e^{u^{\text{sc}}_i} > \frac \varepsilon\kappa$ or $e^{u^{\text{sc}}_i} = \frac \varepsilon\kappa$. In one hand, if $e^{u^{\text{sc}}_i} > \frac \varepsilon\kappa$ then according to the optimality conditions $\lambda^{\text{sc}}_i = 0.$ Then $e^{u^{\text{sc}}_i} \sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j} = \kappa\mu_i$.
In another hand, we have 
\begin{align*}
e^{u^{\text{sc}}_i} \min_{i,j}K_{ij} \sum_{j=1}^m e^{v^{\text{sc}}_j} \leq e^{u^{\text{sc}}_i} \sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j} = \kappa\mu_i.
\end{align*}
We further observe that $\sum_{j=1}^m e^{v^{\text{sc}}_j} = \sum_{j \in J_{\varepsilon,\kappa}} e^{v^{\text{sc}}_j} + \sum_{j \in J^\complement_{\varepsilon,\kappa}} e^{v^{\text{sc}}_j} \geq \varepsilon\kappa |J_{\varepsilon,\kappa}| + \varepsilon\kappa |J^\complement_{\varepsilon,\kappa}|=\varepsilon\kappa m.$ Then
\begin{equation*}
\max_{i\in I_{\varepsilon,\kappa}} e^{u^{\text{sc}}_i} \leq \frac \varepsilon\kappa \vee \frac{\max_{i\in I_{\varepsilon,\kappa}}\mu_i}{m\varepsilon \min_{i,j}K_{ij}}.
\end{equation*}
Analogously, one can obtain for all $j\in J_{\varepsilon,\kappa}$
\begin{equation}
\label{upper_bound_v_potential}
\max_{j\in J_{\varepsilon,\kappa}}e^{v^{\text{sc}}_j} \leq \varepsilon\kappa \vee \frac{\max_{j \in J_{\varepsilon,\kappa}} \nu_j}{n\varepsilon\min_{i,j}K_{ij}}.
\end{equation}

Now, since $K_{ij} \leq 1$, we have 
\begin{align*}
e^{u^{\text{sc}}_i} \sum_{j=1}^m e^{v^{\text{sc}}_j} \geq e^{u^{\text{sc}}_i} \sum_{j=1}^m K_{ij}e^{v^{\text{sc}}_j} = \kappa\mu_i.
\end{align*}
Using~\eqref{upper_bound_v_potential}, we get 
\begin{align*}
\sum_{j=1}^m e^{v^{\text{sc}}_j} &= \sum_{j \in J_{\varepsilon,\kappa}} e^{v^{\text{sc}}_j} + \sum_{j \in J^\complement_{\varepsilon,\kappa}} e^{v^{\text{sc}}_j}
\leq \varepsilon\kappa |J^\complement_{\varepsilon,\kappa}| + \varepsilon\kappa \vee \frac{\max_{j\in J_{\varepsilon,\kappa}} \nu_j}{n\varepsilon\min_{i,j}K_{ij}} |J_{\varepsilon,\kappa}|.
\end{align*}
Therefore,
\begin{align*}
\min_{i \in I_{\varepsilon,\kappa}} e^{u^{\text{sc}}_i}  \geq \frac \varepsilon\kappa \vee \frac{\kappa\min_{I_{\varepsilon,\kappa}}\mu_i}{\varepsilon\kappa (m-m_b) + \varepsilon\kappa \vee \frac{\max_{j\in J_{\varepsilon,\kappa}} \nu_j}{n\varepsilon\min_{i,j}K_{ij}} m_b}.
\end{align*}

$\hfill\square$

\section{Proof of Lemma~\ref{lemma_bounds_on_marginals}}


The optimality condition for $({u}^{\text{sc}}, {v}^{\text{sc}})$ entails 
\begin{align}
\label{i-th-marginal-mu} %=({B}({u}^{\text{sc}},{v}^{\text{sc}})\mathbf 1_m)_i
{\mu}^{\text{sc}}_i  &= 
\begin{cases}
e^{u^{\text{sc}}_i} \sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}, \text{ if  }i \in I_{\varepsilon,\kappa},\\
\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}, \text{ if  }i \in I^\complement_{\varepsilon,\kappa}
\end{cases}
=\begin{cases}
\kappa \mu_i, \text{ if  }i \in I_{\varepsilon,\kappa},\\
\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}, \text{ if  }i \in I^\complement_{\varepsilon,\kappa}.
\end{cases}
\end{align}
Using Inequality~\eqref{bound_on_v}, we obtain 
\begin{align*}
\norm{\mu^{\text{sc}}}_1 &= \sum_{i \in I_{\varepsilon,\kappa}} \mu^{\text{sc}}_i +  \sum_{i \in I^\complement_{\varepsilon,\kappa}}\mu^{\text{sc}}_i\\
& \overset{\eqref{i-th-marginal-mu}}{=} \kappa \norm{\mu_{I_{\varepsilon,\kappa}}^{\text{sc}}}_1 + \frac \varepsilon\kappa \sum_{i \in I^\complement}\Big( \sum_{j \in J_{\varepsilon,\kappa}} K_{ij} e^{v^{\text{sc}}_j} + \varepsilon\kappa \sum_{j\in J^\complement_{\varepsilon,\kappa}}K_{ij}\Big)\\
& \overset{\eqref{bound_on_v}}{\leq} \kappa \norm{\mu_{I_{\varepsilon,\kappa}}^{\text{sc}}}_1 + (n-n_b) \Big(\frac{m_b\max_{j \in J_{\varepsilon,\kappa}} \nu_j}{n\kappa\min_{i,j}K_{ij}} + (m-m_b)\varepsilon^2 \Big)
\end{align*}
Similarly, we can prove the same statement for $\norm{\nu^{\text{sc}}}_1$.

$\hfill\square$

\section{Proof of Proposition~\ref{proposition_error_in_marginals}}

We define the distance function $\varrho: \R_+ \times \R_+ \mapsto [0, \infty]$ by $\varrho(a,b) = b - a + a \log(\frac ab).$
While $\varrho$ is not a metric, it is easy to see that $\varrho$ is not nonnegative and satisfies $\varrho(a,b) =0$ iff $a=b$.

Straighforward, 
\begin{align*}
\varrho({\mu} ,{\mu}^{\text{sc}}) &= \sum_{i=1}^n  {\mu}^{\text{sc}}_i - {\mu}_i + {\mu}_i  \log\Big(\frac{{\mu}_i}{{\mu}^{\text{sc}}_i }\Big)\\
&= \sum_{i\in I_{\varepsilon,\kappa}} (\kappa-1)\mu_i - \mu_i\log(\kappa) + \sum_{i\in I^\complement_{\varepsilon,\kappa}}\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j} - \mu_i + \mu_i \log\Big(\frac{\mu_i}{\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}}\Big)\\
&= \sum_{i\in I_{\varepsilon,\kappa}} (\kappa-\log(\kappa)-1)\mu_i  + \sum_{i\in I^\complement_{\varepsilon,\kappa}}\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j} - \mu_i + \mu_i \log\Big(\frac{\mu_i}{\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}}\Big)\\
&\leq  \sum_{i\in I^\complement_{\varepsilon,\kappa}}\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j} - \mu_i + \mu_i \log\Big(\frac{\mu_i}{\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}}\Big)
\end{align*}
Using~\eqref{bound_on_v}, we have in one hand 
\begin{align*}
\sum_{i\in I^\complement_{\varepsilon,\kappa}}\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}&= \sum_{i\in I^\complement_{\varepsilon,\kappa}}\frac \varepsilon\kappa \Big(\sum_{j\in J_{\varepsilon,\kappa}}K_{ij} e^{v^{\text{sc}}_j} + \varepsilon \kappa\sum_{j\in J^\complement_{\varepsilon,\kappa}}K_{ij}\Big)\\
&\leq \sum_{i\in I^\complement_{\varepsilon,\kappa}}\frac \varepsilon\kappa \Big(m_b \max_{i,j}K_{ij}\frac{\max_{j \in J_{\varepsilon,\kappa}} \nu_j}{n\varepsilon\min_{i,j}K_{ij}} + (m - m_b)\varepsilon\kappa\max_{i,j}K_{ij}\Big) \\
&\leq (n-n_b)\Big(\frac{m_b\max_{j} \nu_j}{n\kappa\min_{i,j} K_{ij}} + (m- m_b) \varepsilon^2\Big).
\end{align*}
On the other hand 
\begin{align*}
\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}&=\frac \varepsilon\kappa \Big(\sum_{j\in J_{\varepsilon,\kappa}}K_{ij} e^{v^{\text{sc}}_j} + \varepsilon \kappa\sum_{j\in J^\complement_{\varepsilon,\kappa}}K_{ij}\Big)\\
&\geq m_b\min_{i,j}K_{ij} \frac{m\varepsilon^2\min_{i,j}K_{ij}\min_{j \in J_{\varepsilon,\kappa}}\nu_j}{\kappa((n-n_b)m\varepsilon^2\min_{i,j}K_{ij} + m\varepsilon^2\min_{i,j}K_{ij} + \kappa\max_{i\in I_{\varepsilon,\kappa}}\mu_i)}\\
&\qquad +\varepsilon^2 (m- m_b) \min_{i,j}K_{ij}\\
&\geq \frac{mm_b\varepsilon^2(\min_{i,j}K_{ij})^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}{\kappa((n-n_b)m\varepsilon^2\min_{i,j}K_{ij}+ m\varepsilon^2\min_{i,j}K_{ij} + \kappa\max_{i\in I_{\varepsilon,\kappa}}\mu_i)}\\
&\qquad +\varepsilon^2 (m- m_b) \min_{i,j}K_{ij}\\
&\geq \frac{mm_b\varepsilon^2(\min_{i,j}K_{ij})^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}{\kappa((n-n_b)m\varepsilon^2\min_{i,j}K_{ij}+ m\varepsilon^2\min_{i,j}K_{ij} + \kappa\max_{i\in I_{\varepsilon,\kappa}}\mu_i)}.
\end{align*}
Then 
\begin{align*}
\frac{1}{\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}} &\leq \frac{\kappa((n-n_b)m\varepsilon^2\min_{i,j}K_{ij}+ m\varepsilon^2\min_{i,j}K_{ij} + \kappa\max_{i\in I_{\varepsilon,\kappa}}\mu_i)}{mm_b\varepsilon^2(\min_{i,j}K_{ij})^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}\\
&\leq \frac{\kappa(n-n_b+ 1)}{m_b\min_{i,j}K_{ij}\min_{j \in J_{\varepsilon,\kappa}}\nu_j} + \frac{\kappa^2}{mm_b\varepsilon^2(\min_{i,j}K_{ij})^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}.
\end{align*}
Therefore
\begin{align*}
&\sum_{i\in I^\complement_{\varepsilon,\kappa}}\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j} - \mu_i + \mu_i \log\Big(\frac{\mu_i}{\frac \varepsilon\kappa\sum_{j=1}^m K_{ij} e^{v^{\text{sc}}_j}}\Big)\\
&\leq (n-n_b)\bigg(\frac{m_b}{n\kappa\min_{i,j} K_{ij}} + (m- m_b) \varepsilon^2 - \min_{i}\mu_i\\
&\qquad + \max_{i}\mu_i\log\Big(\frac{\kappa(n-n_b+ 1)\max_{i}\mu_i}{m_b\min_{i,j}K_{ij}\min_{j \in J_{\varepsilon,\kappa}}\nu_j} + \frac{\kappa^2\max_{i}\mu_i}{mm_b\varepsilon^2(\min_{i,j}K_{ij})^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}\Big)
\bigg)
\end{align*}
Therefore
\begin{align*}
\varrho({\mu},{\mu}^{\text{sc}}) &\leq n_b(\kappa-\log(\kappa)-1)\max_{i} \mu_i + (n-n_b)\bigg(\frac{m_b\max_{j}\nu_j}{n\kappa\min_{i,j} K_{ij}} + (m- m_b) \varepsilon^2 - \min_{i}\mu_i\\
&\qquad + \max_{i} \mu_i\log\Big(\frac{\kappa(n-n_b+ 1)\max_{i} \mu_i}{m_b\min_{i,j}K_{ij}\min_{j \in J_{\varepsilon,\kappa}}\nu_j} + \frac{\kappa^2\max_{i} \mu_i}{mm_b\varepsilon^2(\min_{i,j}K_{ij})^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}\Big)
\end{align*}
Finally, by Lemma 6 in~\cite{altschulernips17} we get 
\begin{align*}
\norm{{\mu}^\star -{\mu}^{\text{sc}}}^2_1 \leq & n_b(\kappa-\log(\kappa)-1)\max_{i} \mu_i + 7(n-n_b)\bigg(\frac{m_b\max_{j}\nu_j}{n\kappa\min_{i,j} K_{ij}} + (m- m_b) \varepsilon^2 - \min_{i}\mu_i\\
&+ \max_{i} \mu_i\log\Big(\frac{\kappa(n-n_b+ 1)\max_{i} \mu_i}{m_b\min_{i,j}K_{ij}\min_{j \in J_{\varepsilon,\kappa}}\nu_j} + \frac{\kappa^2\max_{i} \mu_i}{mm_b\varepsilon^2(\min_{i,j}K_{ij})^2\min_{j \in J_{\varepsilon,\kappa}}\nu_j}\Big).%\bigg\}^{1/2}
\end{align*}
Proof of the upper bound for $\norm{\nu - {\nu}^{\text{sc}}}^2_1$ follows the same lines as above.

$\hfill\square$


\small
\bibliography{biblio}
\bibliographystyle{plain}

\end{document}

\newpage 
\newpage

\section{Bounding dual objective values}

For each vectors $u \in \mathcal{U}_{\text{sc}}$ and $v\in \mathcal{V}_{\text{sc}}$ we define its rearrgement 
\begin{equation*}
\dt{u} =(u_{I_{\varepsilon,\kappa}}^\top, u_{I^\complement_{\varepsilon,\kappa}}^\top)^\top = (u_{I_{\varepsilon,\kappa}}^\top, \log(\frac\varepsilon\kappa)\mathbf1_{n- n_b}^\top)^\top,
\end{equation*}
and 
\begin{equation*}
\dt{v} =(v_{J_{\varepsilon,\kappa}}^\top, v_{J^\complement_{\varepsilon,\kappa}}^\top)^\top = (v_{J_{\varepsilon,\kappa}}^\top, \log(\varepsilon\kappa)\mathbf 1_{m- m_b}^\top)^\top.
\end{equation*}


\begin{proposition}
Let $k\geq 1$ and $u^{sc}_k, v^{sc}_k$ be generated by Screenkhorn. Then, ones has 
\begin{align*}
\Psi_{\varepsilon, \kappa}(u^{\text{sc}}_k ,v^{\text{sc}}_k) -\Psi(u^\star, v^\star)
&\leq \norm{\kappa \dt{u}^{\text{sc}}_k - \dt{u}^\star}_\infty \norm{\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m - \dt{\mu}}_1 + \norm{\kappa^{-1}\dt{v}^{\text{sc}}_k - \dt{v}^\star}_\infty \norm{\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n - \dt{\nu}}_1\\
&\qquad + (1- \kappa)\inr{\dt{u}^{\text{sc}}_k ,\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} + (1- \kappa^{-1})\inr{\dt{v}^{\text{sc}}_k ,\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}.
\end{align*}
\end{proposition}

%\begin{proof}
Let us fix $k\geq 1$ and consider the convex function
\begin{equation*}
	(\hat u, \hat v) \mapsto \inr{\mathbf 1_n, \tilde{B}(\dt{\hat u}^{\text{}} ,\dt{\hat v}^{\text{}})\mathbf 1_m} - \inr{\kappa\dt{\hat u}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} - \inr{\kappa^{-1}\dt{\hat v}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}.
\end{equation*}
Gradient inequality of any convex function g at point $x_o$ reads as $g(x_o) \geq g(x) + \inr{\nabla g(x), x_o - x}, \text{ for all } x \in \textbf{dom}(g).$
Applying the latter fact to the above function at point ($u^{\star}, v^{\star})$ we obtain
\begin{align*}
&\inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} - \inr{\kappa\dt{u}^{\text{sc}}_k, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} - \inr{\kappa^{-1}\dt{v}^{\text{sc}}_k, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}\\
& - \big(\inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\star} ,\dt{v}^{\star})\mathbf 1_m}  
- \inr{\kappa\dt{u}^{\star{}}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
- \inr{\kappa^{-1}\dt{v}^\star, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n} \big)\\
& \leq \inr{\dt{u}^{\text{sc}}_k - \dt{u}^\star, (1-\kappa) \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
+ \inr{\dt{v}^{\text{sc}}_k - \dt{v}^\star, (1-\kappa^{-1}) \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}.
\end{align*}
Moreover,
\begin{align*}
\Psi_{\varepsilon, \kappa} (u^{\text{sc}}_k ,v^{\text{sc}}_k) -\Psi(u^\star, v^\star)
&= \inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} - \inr{\kappa\dt{u}^{\text{sc}}_k, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} - \inr{\kappa^{-1}\dt{v}_k^{\text{sc}}, \tilde{B}(\dt{u}_k^{\text{sc}}, \dt{v}^{\text{sc}}_k)\mathbf 1_n^\top}\\
& - \big( 
\inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\star} ,\dt{v}^{\star})\mathbf 1_m}  
- \inr{\dt{u}^{\star{}}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
- \inr{\dt{v}^\star, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n} \big)\\
&+ \inr{\kappa \dt{u}^{\text{sc}}_k - \dt{u}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m - \dt{\mu}} + \inr{\kappa^{-1}\dt{v}^{\text{sc}}_k - \dt{v}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n - \dt{\nu}}.
\end{align*}
Hence,
\begin{align*}
&\Psi_{\varepsilon, \kappa} (u^{\text{sc}}_k ,v^{\text{sc}}_k) -\Psi(u^\star, v^\star)\\
&\qquad + \big( \inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\star} ,\dt{v}^{\star})\mathbf 1_m}  
- \inr{\dt{u}^{\star{}}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
- \inr{\dt{v}^\star, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n} \big)\\
& \qquad -\inr{\kappa \dt{u}^{\text{sc}}_k - \dt{u}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m - \dt{\mu}} -\inr{\kappa^{-1}\dt{v}^{\text{sc}}_k - \dt{v}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n - \dt{\nu}}\\
& \leq \inr{\dt{u}^{\text{sc}}_k - \dt{u}^\star, (1-\kappa) \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
+ \inr{\dt{v}^{\text{sc}}_k - \dt{v}^\star, (1-\kappa^{-1}) \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}\\
&\qquad + \big(\inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\star} ,\dt{v}^{\star})\mathbf 1_m}  
- \inr{\kappa\dt{u}^{\star{}}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
- \inr{\kappa^{-1}\dt{v}^\star, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n} \big)
\end{align*}
Then,
\begin{align*}
&\Psi_{\varepsilon, \kappa} (u^{\text{sc}}_k ,v^{\text{sc}}_k) -\Psi(u^\star, v^\star)\\
&\leq \inr{\dt{u}^{\text{sc}}_k - \dt{u}^\star, (1-\kappa) \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
+ \inr{\dt{v}^{\text{sc}}_k - \dt{v}^\star, (1-\kappa^{-1}) \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}\\
&\qquad + \big(\inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\star} ,\dt{v}^{\star})\mathbf 1_m}  
- \inr{\kappa\dt{u}^{\star{}}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
- \inr{\kappa^{-1}\dt{v}^\star, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n} \big)
\\
&\qquad + \inr{\kappa \dt{u}^{\text{sc}}_k - \dt{u}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m - \dt{\mu}} + \inr{\kappa^{-1}\dt{v}^{\text{sc}}_k - \dt{v}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n - \dt{\nu}}\\
&\qquad - \big(\inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\star} ,\dt{v}^{\star})\mathbf 1_m}  
- \inr{\dt{u}^{\star{}}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} 
- \inr{\dt{v}^\star, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top \mathbf 1_n} \big).
\end{align*}
So
\begin{align*}
&\Psi_{\varepsilon, \kappa} (u^{\text{sc}}_k ,v^{\text{sc}}_k) -\Psi(u^\star, v^\star)\\
&\leq  \inr{\kappa \dt{u}^{\text{sc}}_k - \dt{u}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m - \dt{\mu}} +\inr{\kappa^{-1}\dt{v}^{\text{sc}}_k - \dt{v}^{\star}, \tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n - \dt{\nu}}\\
&\qquad + (1- \kappa)\inr{\dt{u}^{\text{sc}}_k ,\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} + (1- \kappa^{-1})\inr{\dt{v}^{\text{sc}}_k ,\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}.
\end{align*}
Applying Holder's inequality entails
\begin{align*}
&\Psi_{\varepsilon, \kappa}(u^{\text{sc}}_k ,v^{\text{sc}}_k) -\Psi(u^\star, v^\star)\\
&\leq \norm{\kappa \dt{u}^{\text{sc}}_k - \dt{u}^\star}_\infty \norm{\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m - \dt{\mu}}_1 + \norm{\kappa^{-1}\dt{v}^{\text{sc}}_k - \dt{v}^\star}_\infty \norm{\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n - \dt{\nu}}_1\\
&\qquad + (1- \kappa)\inr{\dt{u}^{\text{sc}}_k ,\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)\mathbf 1_m} + (1- \kappa^{-1})\inr{\dt{v}^{\text{sc}}_k ,\tilde{B}(\dt{u}^{\text{sc}}_k ,\dt{v}^{\text{sc}}_k)^\top\mathbf 1_n}.
\end{align*}
Next, we bound the right-hand side of this inequality.

If $r \in I^\complement_{\varepsilon, \kappa}$ then 
\begin{align*}
|(\dt{u}^{\text{sc}}_k)_{r} - \dt{u}^\star_r| &= \bigg| \log(\frac \varepsilon\kappa) - \log(\frac{\mu_r}{\sum_{j=1}^m K_{rj}e^{v^\star_j}})\bigg|\\
&= \bigg|\log\Big(\frac{\frac \varepsilon\kappa}{\frac{\mu_r}{\sum_{j=1}^m K_{rj}e^{v^\star_j}}}\Big) \bigg|\\
&= \bigg|\log\bigg(\frac{\sum_{j=1}^m K_{rj}e^{v^\star_j}}{\sum_{j=1}^m \frac{\kappa \mu_r}{m\varepsilon}}\bigg) \bigg|\\
& \leq \bigg|\log\bigg(\max_{1\leq j \leq m} \frac{K_{rj}e^{v^\star_j}}{\frac{\kappa \mu_r}{m\varepsilon}}\bigg) \bigg|\\
& \leq \big|\max_{1\leq j \leq m} (v_j^\star - \log(\frac{\kappa \mu_r}{m\varepsilon})\big|\\
& \leq \norm{v^\star - \log(\frac{\kappa \mu_r}{m\varepsilon})}_\infty \\
& \leq \norm{v^\star - v^{\text{sc}}_k - \log(\frac{\mu_r}{m\varepsilon^2})}_\infty \\
& \leq \norm{v^\star - v^{\text{sc}}_k}_\infty +  \log(m\varepsilon^2).
\end{align*}

If $r \in I_{\varepsilon, \kappa}$ then 
\begin{align*}
|(\dt{u}^{\text{sc}}_k)_{r} - \dt{u}^\star_r| &= \bigg|\log\bigg(\frac{\kappa\mu_r}{\sum_{j\in J_{\varepsilon,\kappa}}K_{rj}e^{(v^{\text{sc}}_k)_j} + \varepsilon\kappa \sum_{j\in J^\complement_{\varepsilon,\kappa}}K_{rj}}\bigg) - \log\bigg(\frac{\mu_r}{\sum_{j=1}^m K_{rj}e^{v^\star_j}}\bigg)\bigg|\\
&= \bigg|\log\bigg(\frac{\kappa\mu_r}{\sum_{j=1}^m K_{rj}e^{(v^{\text{sc}}_k)_j}}\bigg) - \log\bigg(\frac{\mu_r}{\sum_{j=1}^m K_{rj}e^{v^\star_j}}\bigg)\bigg|\\
&= \bigg|\log\bigg(\frac{\kappa\sum_{j=1}^m K_{rj}e^{v^\star_j}}{\sum_{j=1}^m K_{rj}e^{(v^{\text{sc}}_k)_j}}\bigg)\bigg|\\
& \leq \bigg|\log\bigg(\frac{\kappa\sum_{j=1}^m K_{rj}e^{v^\star_j}}{\sum_{j=1}^m K_{rj}e^{(v^{\text{sc}}_k)_j}}\bigg)\bigg|\\
& \leq \norm{(v^{\text{sc}}_k) - v^\star - \log(\kappa)}_\infty\\
& \leq \norm{(v^{\text{sc}}_k) - v^\star}_\infty (\kappa \leq 1)
\end{align*}

If $s \in J^\complement_{\varepsilon, \kappa}$ then 
\begin{align*}
|(\dt{v}^{\text{sc}}_k)_{s} - \dt{v}^\star_s| &= \bigg| \log(\varepsilon\kappa) - \log(\frac{\nu_s}{\sum_{i=1}^n K_{is}e^{u^\star_i}})\bigg|\\
&= \bigg|\log\Big(\frac{\varepsilon\kappa}{\frac{\nu_s}{\sum_{i=1}^n K_{is}e^{u^\star_i}}}\Big) \bigg|\\
&= \bigg|\log\bigg(\frac{\sum_{j=1}^n K_{is}e^{u^\star_i}}{\sum_{i=1}^n \frac{\nu_s}{n\kappa\varepsilon}}\bigg) \bigg|\\
& \leq \bigg|\log\bigg(\max_{1\leq i \leq n} \frac{K_{is}e^{u^\star_i}}{\frac{\nu_s}{n\kappa\varepsilon}}\bigg) \bigg|\\
& \leq \big|\max_{1\leq i \leq n} (u_i^\star - \log(\frac{\nu_s}{n\kappa\varepsilon})\big|\\
& \leq \norm{u^\star - \log(\frac{\kappa \mu_r}{m\varepsilon})}_\infty \\
& \leq \norm{u^\star - u^{\text{sc}}_k - \log(\frac{\nu_s}{n\varepsilon^2})}_\infty \\
& \leq \norm{u^\star - u^{\text{sc}}_k}_\infty +  \log(n\varepsilon^2).
\end{align*}

If $r \in I_{\varepsilon, \kappa}$ then 
\begin{align*}
|(\dt{u}^{\text{sc}}_k)_{r} - \dt{u}^\star_r| &= \bigg|\log\bigg(\frac{\kappa\mu_r}{\sum_{j\in J_{\varepsilon,\kappa}}K_{rj}e^{(v^{\text{sc}}_k)_j} + \varepsilon\kappa \sum_{j\in J^\complement_{\varepsilon,\kappa}}K_{rj}}\bigg) - \log\bigg(\frac{\mu_r}{\sum_{j=1}^m K_{rj}e^{v^\star_j}}\bigg)\bigg|\\
&= \bigg|\log\bigg(\frac{\kappa\mu_r}{\sum_{j=1}^m K_{rj}e^{(v^{\text{sc}}_k)_j}}\bigg) - \log\bigg(\frac{\mu_r}{\sum_{j=1}^m K_{rj}e^{v^\star_j}}\bigg)\bigg|\\
&= \bigg|\log\bigg(\frac{\kappa\sum_{j=1}^m K_{rj}e^{v^\star_j}}{\sum_{j=1}^m K_{rj}e^{(v^{\text{sc}}_k)_j}}\bigg)\bigg|\\
& \leq \bigg|\log\bigg(\frac{\kappa\sum_{j=1}^m K_{rj}e^{v^\star_j}}{\sum_{j=1}^m K_{rj}e^{(v^{\text{sc}}_k)_j}}\bigg)\bigg|\\
& \leq \norm{(v^{\text{sc}}_k) - v^\star - \log(\kappa)}_\infty\\
& \leq \norm{(v^{\text{sc}}_k) - v^\star}_\infty (\kappa \leq 1)
\end{align*}

\section{First order optimality condition}

Let $k\geq 0$ and $u^{sc}_k, v^{sc}_k$ be generated by Algorithm~\ref{screenkhorn} and $(u^\star, v^\star)$ be a solution of~\ref{sinkhorn-dual}. Then 
\begin{align*}
&\Psi_{\varepsilon, \kappa}(u^{sc}_k,v^{sc}_k) - \Psi(u^\star, v^\star)\\
& = \mathbf1_{n_b}^\top B(u_{I_{\varepsilon,\kappa}}, v_{J_{\varepsilon,\kappa}}) \mathbf 1_{m_b} + \varepsilon \kappa (e^{u_{I_{\varepsilon,\kappa}}})^\top K_{(I_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})} + \varepsilon \kappa^{-1} K_{(I^\complement_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})}e^{v_{J_{\varepsilon,\kappa}}}\\
&\qquad - \kappa \mu_{I_{\varepsilon,\kappa}}^\top u_{I_{\varepsilon,\kappa}} - \kappa^{-1} \nu_{J_{\varepsilon,\kappa}}^\top v_{J_{\varepsilon,\kappa}} + \Xi
\end{align*}

\begin{proof}
Let us define $\tilde{K}$ a rearrgement of $K$ with respect to the active sets $I_{\varepsilon,\kappa}$ and $J_{\varepsilon,\kappa}$as follows:
\begin{equation*}
\tilde{K} = 
\begin{bmatrix}
K_{(I_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} & K_{(I_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})}\\
K_{(I^\complement_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} &K_{(I^\complement_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})}
\end{bmatrix}.
\end{equation*}
For each vectors $u \in \mathcal{U}_{\text{sc}}$ and $v\in \mathcal{V}_{\text{sc}}$ we define its rearrgement 
\begin{equation*}
\dt{u} =(u_{I_{\varepsilon,\kappa}}^\top, u_{I^\complement_{\varepsilon,\kappa}}^\top)^\top = (u_{I_{\varepsilon,\kappa}}^\top, \log(\frac\varepsilon\kappa)\mathbf1_{n- n_b}^\top)^\top,
\end{equation*}
and 
\begin{equation*}
\dt{v} =(v_{J_{\varepsilon,\kappa}}^\top, v_{J^\complement_{\varepsilon,\kappa}}^\top)^\top = (v_{J_{\varepsilon,\kappa}}^\top, \log(\varepsilon\kappa)\mathbf 1_{m- m_b}^\top)^\top.
\end{equation*}
We then have 
\begin{equation*}
\Psi_{\varepsilon, \kappa} (u,v) = \mathbf 1_n^\top \tilde{B}(\dt{u}, \dt{v}) \mathbf 1_m - \kappa \dt{\mu}^\top \dt{u} - \kappa^{-1} \dt{\nu}^\top \dt{v},
\end{equation*}
where
\begin{equation*}
  \tilde{B}(\dt{u}, \dt{v}) = \Delta(e^{\dt{u}})\tilde{K} \Delta(e^{\dt{v}}).
\end{equation*}

\begin{align*} 
\nabla_u \Psi_{\varepsilon, \kappa}(u^{\text{sc}},v^{\text{sc}}) &= e^{u^{\text{sc}}_{I_{\varepsilon,\kappa}}} \odot K_{(I_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} e^{v^{\text{sc}}_{J_{\varepsilon,\kappa}}} + \varepsilon\kappa e^{u^{\text{sc}}_{I_{\varepsilon,\kappa}}} \odot K_{(I_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})} \mathbf 1_{m_b} - \kappa \mu_{I_{\varepsilon,\kappa}}\\
&= 
\begin{bmatrix}
e^{u^{\text{sc}}_{I_{\varepsilon,\kappa}}}\\
e^{u^{\text{sc}}_{I^\complement_{\varepsilon,\kappa}}}
\end{bmatrix}
\tilde{K}^1_O
\begin{bmatrix}
e^{v^{\text{sc}}_{J_{\varepsilon,\kappa}}}\\
e^{v^{\text{sc}}_{J^\complement_{\varepsilon,\kappa}}}
\end{bmatrix}
- \kappa \mu_{I_{\varepsilon,\kappa}},\\
\end{align*}
where 
\begin{equation*}
\tilde{K}^1_O = 
\begin{bmatrix}
K_{(I_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} & K_{(I_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})}\\
\mathbf O_{(I^\complement_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} &\mathbf O_{(I^\complement_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})}
\end{bmatrix}.
\end{equation*}
and 
\begin{align*} 
\nabla_v \Psi_{\varepsilon, \kappa}(u^{\text{sc}},v^{\text{sc}}) &= e^{v^{\text{sc}}_{J_{\varepsilon,\kappa}}} \odot K^\top_{(I_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} e^{u^{\text{sc}}_{I_{\varepsilon,\kappa}}} + \frac\varepsilon\kappa e^{v^{\text{sc}}_{J_{\varepsilon,\kappa}}} \odot K^\top_{(I^\complement_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} \mathbf 1_{n_b} - \kappa^{-1} \nu_{J_{\varepsilon,\kappa}}\\
&= 
\begin{bmatrix}
e^{v^{\text{sc}}_{J_{\varepsilon, \kappa}}}\\
e^{v^{\text{sc}}_{J^\complement_{\varepsilon, \kappa}}}
\end{bmatrix}
\tilde{K}^2_O
\begin{bmatrix}
e^{u^{\text{sc}}_{I_{\varepsilon,\kappa}}}\\
e^{u^{\text{sc}}_{I^\complement_{\varepsilon,\kappa}}}
\end{bmatrix}
- \kappa^{-1} \nu_{J_{\varepsilon,\kappa}}\\
\end{align*}
where 
\begin{equation*}
\tilde{K}^2_O = 
\begin{bmatrix}
K_{(I_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} &\mathbf O_{(I_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})}\\
K_{(I^\complement_{\varepsilon,\kappa}, J_{\varepsilon,\kappa})} &\mathbf O_{(I^\complement_{\varepsilon,\kappa}, J^\complement_{\varepsilon,\kappa})}
\end{bmatrix}.
\end{equation*}
Therefore, we obtain 
\begin{equation*}
\nabla_u \Psi_{\varepsilon, \kappa}(u^{\text{sc}},v^{\text{sc}}) = \tilde{B}^1_O(\dt{u}^{\text{sc}},\dt{v}^{\text{sc}}) \mathbf 1_m - \kappa \mu_{I_{\varepsilon,\kappa}} \text{ and } \nabla_v \Psi_{\varepsilon, \kappa}(u^{\text{sc}},v^{\text{sc}}) = \tilde{B}^2_O(\dt{u}^{\text{sc}},\dt{v}^{\text{sc}})^\top \mathbf 1_n- \kappa^{-1} \nu_{J_{\varepsilon,\kappa}}
\end{equation*}

Analogously, one can define 
\begin{align*}
\Psi(u^\star, v^\star) = \mathbf{1}_n \tilde{B}(\dt{u}^\star, \dt{v}^\star) \mathbf{1}_m - \dt{\mu}^\top \dt{u}^\star - \dt{\nu}^\top \dt{v}^\star
\end{align*}
Hence,
\begin{align*} 
 \Psi_{\varepsilon, \kappa} (u^{\text{}} ,v^{\text{}}) -\Psi(u^\star, v^\star)
& = \inr{\mathbf 1_n, \tilde{B}(\dt{u}^{\text{}} ,\dt{v}^{\text{}})\mathbf 1_m} - \inr{\mathbf{1}_n, \tilde{B}(\dt{u}^{\star} ,\dt{v}^{\star})\mathbf 1_m} + \inr{\dt{u}^{\star} - \kappa \dt{u}^{\text{}}, \dt{\mu}} + \inr{\dt{v}^{\star} - \kappa^{-1}\dt{v}^{\text{}}, \dt{\nu}}.
\end{align*}
\end{proof}

\small
\bibliography{biblio}
\bibliographystyle{plain}

\end{document}